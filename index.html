<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Eye — Never Forget</title>
  <meta name="description" content="The Eye keeps social issues in focus until they're resolved." />
  <link rel="stylesheet" href="styles.css" />
  <!-- Supabase SDK (Auth/DB) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <span class="logo" aria-hidden="true">◎</span>
      <h1>THE EYE</h1>
    </div>
    <nav>
      <a href="#" id="aboutLink">About</a>
      <a href="#" id="submitLink" title="이슈 제보">Submit</a>
      <a href="#" id="howToHelpLink">How to help</a>
      <select id="langSelect" aria-label="Language">
        <option value="auto">Auto</option>
        <option value="ko">한국어</option>
        <option value="en">English</option>
        <option value="ja">日本語</option>
      </select>
      <button id="authBtn" class="btn small">Sign in</button>
    </nav>
  </header>

  <main class="container">
    <section class="hero">
      <h2>Never let it fade.</h2>
      <p>The Eye keeps unresolved social issues in view — tracked, sourced, and easy to share.</p>
    </section>

    <section class="tools">
      <label for="search" class="sr-only">Search issues</label>
      <input id="search" type="search" placeholder="Search issues (title, summary, tags)" autocomplete="off" />

      <div id="tags" class="tags" aria-label="Filter by tag"></div>
      <div class="toggles">
        <label><input type="checkbox" id="showFollowed" /> Show followed only</label>
        <label class="sort">
          Sort:
          <select id="sortBy">
            <option value="priority">Urgency (high→low)</option>
            <option value="title">Title (A→Z)</option>
            <option value="status">Status</option>
          </select>
        </label>
      </div>
    </section>

    <section id="list" class="list" aria-live="polite">
      <!-- Cards rendered here -->
    </section>
  </main>

  <footer class="site-footer">
    <p>© <span id="year"></span> The Eye. Black &amp; white by design. Accessible by necessity.</p>
  </footer>

  <!-- Issue details modal -->
  <dialog id="issueDialog" class="dialog">
    <button class="dialog-close" aria-label="Close" id="dialogClose">×</button>
    <div id="dialogContent"></div>
  </dialog>

  <!-- Static info dialog (About / How to help) -->
  <dialog id="staticDialog" class="dialog">
    <button class="dialog-close" aria-label="Close" id="staticClose">×</button>
    <div id="staticContent"></div>
  </dialog>

  <!-- Submit dialog -->
  <dialog id="submitDialog" class="dialog">
    <button class="dialog-close" aria-label="Close" id="submitClose">×</button>
    <form id="submitForm" class="dialog-body">
      <h3 style="margin-top:0">Submit an issue</h3>
      <label>Title<input id="subTitle" required /></label>
      <label>Summary<textarea id="subSummary" rows="3"></textarea></label>
      <label>Details<textarea id="subDetails" rows="6"></textarea></label>
      <label>Tags (comma-separated)<input id="subTags" placeholder="예: 노동, 안전" /></label>
      <label>Region<input id="subRegion" placeholder="KR" /></label>
      <label>Priority (0~5)<input id="subPriority" type="number" min="0" max="5" value="0" /></label>
      <fieldset>
        <legend>Source (optional)</legend>
        <label>Title<input id="subSourceTitle" /></label>
        <label>URL<input id="subSourceUrl" type="url" placeholder="https://..." /></label>
      </fieldset>
      <p style="font-size:12px;opacity:.75">제출 즉시 공개되지 않습니다. 운영자 승인 후 노출됩니다.</p>
      <button class="btn" type="submit">Submit</button>
    </form>
  </dialog>

  <!-- Login dialog -->
  <dialog id="loginDialog" class="dialog">
    <button class="dialog-close" aria-label="Close" id="loginClose">×</button>
    <form id="loginForm" class="dialog-body">
      <h3 style="margin-top:0">Sign in</h3>
      <label>Email<input id="loginEmail" type="email" required /></label>
      <label>Password<input id="loginPassword" type="password" required /></label>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button class="btn" type="submit">Sign in</button>
        <button class="btn" type="button" id="goSignup">Create account</button>
      </div>
    </form>
  </dialog>

  <!-- JS는 모든 모달 마크업 뒤에서 한 번만 로드 -->
  <script src="script.js?v=7"></script>
</body>
</html>
